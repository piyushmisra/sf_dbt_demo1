version: 2

models:
  - name: dim_patients_scd2
    description: "SCD2 history table for patients with counters for debugging."
    columns:
      - name: patient_sk
        tests:
          - not_null
          - unique

      - name: natural_key
        tests:
          - not_null

      - name: scd_hash
        tests:
          - not_null

      - name: valid_from
        tests:
          - not_null

      - name: is_current
        tests:
          - not_null
          - accepted_values:
                values: [true, false]

  - name: dim_patients
    description: "Thin view on top of dim_patients_scd2."
